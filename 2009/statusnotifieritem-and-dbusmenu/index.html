pub_date: 2009-12-24 21:00:00 +01:00
public: yes
tags: ["KDE","StatusNotifierItem","GNOME","DBusMenu"]
title: "StatusNotifierItem and DBusMenu"

<p>One of the projects my team at Canonical is working on is a <a href="http://gould.cx/ted/blog/Having_a_tidy_systray">GNOME implementation</a> of the <a href="http://www.notmart.org/misc/statusnotifieritem/">StatusNotifierItem spec</a> created by Plasma developers, as well as another spec named DBusMenu. The goal of DBusMenu is to make it possible for applications using the StatusNotifierItem spec to send their menus over DBus, so that the workspace can display them in a consistent way, regardless of whether the application is written using Qt, GTK or another toolkit.</p>
<p>As the KDE guy of the team, I have been working on implementing DBusMenu for KDE. It is still very much a work in progress, but it's starting to take shape. Here is a screencast of what it looks like so far:</p>
<p><iframe src="http://blip.tv/play/AYG5iC4C.html?p=1" width="800" height="638" frameborder="0" allowfullscreen>
</iframe><embed type="application/x-shockwave-flash" src="http://a.blip.tv/api.swf#AYG5iC4C" style="display:none"></embed></p>
<a href="http://blip.tv/file/get/Agateau-StatusNotifierItemAndDBusMenu771.ogv">Download original</a>
<p>As you can see, it still needs a lot of work, for example support for menu titles is not there yet and Rhythmbox icons are not found (surprisingly, KDE does not ship with "gtk-quit" or "gtk-media-next" icons :)). But it's starting to be usable, and I find it nice to get a Plasma-themed menu when I right-click on the Rhythmbox icon! It's also nice to get mouse over effects on this icon as well (it's not very visible in this video, but look at the Rhythmbox icon at 0:27)</p>
<p>This definitely won't be part of KDE 4.4, but hopefully should be ready for 4.5. For now the KDE part of this work is hosted on KDE Subversion server, in a work branch: <a href="http://websvn.kde.org/branches/work/~agateau/dbusmenu/">branches/work/~agateau/dbusmenu</a>.</p>
<p>PS: The version of Rhythmbox you see in this screencast comes from the <a href="https://launchpad.net/~indicator-applet-developers/+archive/indicator-core-ppa/">Personal Package Archive (PPA)</a> Ted mentioned in his post.</p>
<p>PPS: Should you be interested in trying this, contact me because for now you need special versions of libdbusmenu and libappindicator (the libraries behind the GTK implementation) for the icon and menu to show up in KDE System Tray applet.</p>
<p>Update: Moved video to blip.tv because vimeo.com does not allow downloading the original if one does not have an account.</p>
